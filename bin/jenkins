#!/usr/bin/env bash
#
# Control script to allow an easy command line interface to Jenkins.
# By Thomas Duerr, 19.09.2012
#
#
# DEPENDENCY
#
#   ln -sfv /usr/local/opt/jenkins/*.plist ~/Library/LaunchAgents
#
# TROUBLESHOOTING
#
#   http://apple.stackexchange.com/questions/41412/using-tmux-and-pbpaste-pbcopy-and-launchctl
#


message() {
  printf "\n\033[1;30m $1\033[0m\n"
}
test -z $1 && message "usage: jenkins start | stop | reload" && exit 1

ERROR=0
LAUNCHD_JOB=~/Library/LaunchAgents/homebrew.mxcl.jenkins.plist

case $1 in
  start)
    launchctl load $LAUNCHD_JOB
    message "jenkins started on localhost:8080"
    ERROR=$?
    ;;
  stop)
    launchctl unload $LAUNCHD_JOB
    message "jenkins stopped"
    ERROR=$?
    ;;
  reload)
    launchctl load $LAUNCHD_JOB 2> /dev/null
    launchctl unload $LAUNCHD_JOB
    message "jenkins reloaded"
    ERROR=$?
    ;;
esac

exit $ERROR

